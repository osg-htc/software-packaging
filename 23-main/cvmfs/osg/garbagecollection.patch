From a6259be80b6485328cc83afb182dce436e218ebb Mon Sep 17 00:00:00 2001
From: Dave Dykstra <2129743+DrDaveD@users.noreply.github.com>
Date: Thu, 31 Jul 2025 16:40:18 -0500
Subject: [PATCH] Really fix updating of last_gc when no gc is run under gc -a
 without dry run

---
 cvmfs/server/cvmfs_server_gc.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/cvmfs/server/cvmfs_server_gc.sh b/cvmfs/server/cvmfs_server_gc.sh
index 48de080cf2..7e7a381e63 100644
--- a/cvmfs/server/cvmfs_server_gc.sh
+++ b/cvmfs/server/cvmfs_server_gc.sh
@@ -91,7 +91,7 @@ cvmfs_server_gc() {
       for name in $names; do
         if is_stratum0 $name || __was_garbage_collected_upstream $name; then
           collectable_names="$collectable_names $name"
-        elif [ $dry_run -ne 0 ]; then
+        elif [ $dry_run -eq 0 ]; then
           # pretend that gc was done to keep monitors happy
           update_repo_status $name last_gc "`date --utc`"
         fi
